# 实施计划

- [ ] 1. 创建认证状态管理和类型定义
  - 在 types/index.ts 中添加认证状态枚举和接口定义
  - 定义 AuthState 枚举、VerificationState 接口和 SignUpResult 接口
  - 创建错误消息映射常量
  - _需求: 1.1, 2.1, 4.1_

- [ ] 2. 扩展 AuthContext 以支持邮箱验证流程
  - 在 AuthContext 中添加认证状态管理
  - 实现 confirmSignUp 函数调用 AWS Cognito 确认接口
  - 实现 resendConfirmationCode 函数重新发送验证码
  - 修改 signup 函数返回验证状态而不是直接登录
  - _需求: 1.1, 2.1, 2.2, 3.1_

- [ ] 3. 创建验证码输入组件
  - 创建 VerificationCodeInput.tsx 组件
  - 实现6位数字验证码输入框，支持自动聚焦和格式验证
  - 添加重新发送验证码按钮和60秒倒计时功能
  - 实现返回编辑邮箱的功能
  - 显示部分隐藏的邮箱地址
  - _需求: 1.2, 3.2, 4.1, 4.2, 4.4_

- [ ] 4. 修改 LoginForm 组件支持验证码流程
  - 在 LoginForm 中集成认证状态管理
  - 根据 authState 条件渲染注册表单或验证码输入界面
  - 处理注册成功后的状态切换到验证码输入
  - 实现验证码确认成功后的自动登录
  - _需求: 1.1, 1.3, 2.3_

- [ ] 5. 实现错误处理和用户反馈
  - 在验证码组件中添加错误状态显示
  - 实现 Cognito 错误码到用户友好消息的映射
  - 添加网络错误和重试机制
  - 处理验证码过期和重发限制场景
  - _需求: 1.4, 2.4, 3.3_

- [ ] 6. 添加组件样式和用户体验优化
  - 为验证码输入组件添加 Tailwind CSS 样式
  - 实现响应式设计，确保在移动设备上良好显示
  - 添加加载状态和按钮禁用状态
  - 优化输入框焦点管理和键盘导航
  - _需求: 4.2, 4.3_

- [ ] 7. 编写单元测试
  - 为 AuthContext 的新功能编写测试
  - 为 VerificationCodeInput 组件编写测试
  - 为 LoginForm 的状态切换逻辑编写测试
  - 测试错误处理和边界情况
  - _需求: 1.1, 1.4, 2.2, 3.2_

- [ ] 8. 集成测试和端到端验证
  - 编写完整注册流程的集成测试
  - 测试与 AWS Cognito 的实际交互
  - 验证邮件发送和验证码确认功能
  - 测试各种错误场景的处理
  - _需求: 1.3, 2.3, 3.1, 3.3_